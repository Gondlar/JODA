<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.19"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JODA: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="JODA.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JODA
   &#160;<span id="projectnumber">0.13.0(46cf767)</span>
   </div>
   <div id="projectbrief">JSON On-Demand Analysis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.19 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">JODA Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__home_nico_projects_tmp-joda-dirs_JODA-gh_README"></a></p><h1>Joda - JSON On-Demand Analysis</h1>
<div style="text-align:center"> <a href="https://joda-explore.github.io/JODA"><img src="https://dbis.informatik.uni-kl.de/files/icons/JODA.png" alt="" width="380" class="inline"/> </a> <br  />
 <a href="https://dbis.informatik.uni-kl.de"><img src="https://dbis.informatik.uni-kl.de/images/dbislogo_default.png" alt="" width="130" class="inline"/> </a> </div><p>JODA is an in-memory vertically scalable data processor for semi-structured data, with an initial emphasis on JSON datasets. It can be used to efficiently filter, transform, and aggregate a large set of JSON documents.</p>
<ul>
<li><a href="#installation">Installation</a><ul>
<li><a href="#docker">Docker</a></li>
<li><a href="#packages">Packages</a></li>
<li><a href="#precompiled">Precompiled</a><ul>
<li><a href="#requirements">Requirements</a></li>
</ul>
</li>
<li><a href="#compiling">Compiling</a><ul>
<li><a href="#requirements-1">Requirements</a></li>
<li><a href="#commands">Commands</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#program-flags">Program Flags</a></li>
<li><a href="#cli-commands">CLI Commands</a></li>
<li><a href="#queries">Queries</a><ul>
<li><a href="#syntax">Syntax</a><ul>
<li><a href="#load">Load</a></li>
<li><a href="#sources">Sources</a><ul>
<li><a href="#sampling">Sampling</a></li>
</ul>
</li>
<li><a href="#choose-optional">CHOOSE (Optional)</a><ul>
<li><a href="#variables">Variables</a></li>
<li><a href="#comparison">Comparison</a></li>
</ul>
</li>
<li><a href="#as-optional">AS (Optional)</a><ul>
<li><a href="#source">Source</a></li>
<li><a href="#set-functions">Set Functions</a></li>
<li><a href="#examples">Examples</a></li>
</ul>
</li>
<li><a href="#agg-optional">AGG (Optional)</a><ul>
<li><a href="#keywords">Keywords</a></li>
<li><a href="#group-by">GROUP BY</a></li>
<li><a href="#examples-1">Examples</a></li>
</ul>
</li>
<li><a href="#store-optional">STORE (Optional)</a></li>
<li><a href="#delete-optional">DELETE (Optional)</a></li>
</ul>
</li>
<li><a href="#group-by-1">Group By</a><ul>
<li><a href="#source-1">Source</a></li>
<li><a href="#examples-2">Examples</a></li>
</ul>
</li>
<li><a href="#misc">Misc</a><ul>
<li><a href="#functions">Functions</a><ul>
<li><a href="#metadata-file-functions">Metadata-/File-Functions</a></li>
<li><a href="#type-functions">Type-Functions</a></li>
<li><a href="#casting-functions">Casting-Functions</a></li>
<li><a href="#string-functions">String-Functions</a></li>
<li><a href="#array-functions">Array-Functions</a></li>
<li><a href="#object-functions">Object-Functions</a></li>
<li><a href="#mathematical-functions">Mathematical-Functions</a></li>
<li><a href="#trigonometric-functions">Trigonometric-Functions</a></li>
<li><a href="#mathematical-constants">Mathematical-Constants</a></li>
<li><a href="#time-functions">Time-Functions</a></li>
<li><a href="#misc-functions">Misc-Functions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><a href="#parameters">Parameters</a></p><ul>
<li><a href="#json-pointer">JSON-Pointer</a></li>
</ul>
<p><a href="#example-queries">Example Queries</a></p><ul>
<li><a href="#citation">Citation</a><ul>
<li><a href="#bibtex">Bibtex:</a></li>
</ul>
</li>
</ul>
<h1>Installation</h1>
<h2>Docker</h2>
<p>The easiest way to get JODA up and running is to use our Docker image available in the GitHub registry.</p>
<h2>Packages</h2>
<p>Packages to use with distro package managers are currently built for:</p><ul>
<li>Debian Bullseye</li>
<li>Ubuntu 20.04</li>
</ul>
<h2>Precompiled</h2>
<p>Precompiled binary executables are can be downloaded from the release section on this repo.</p>
<h3>Requirements</h3>
<p>To be able to use the main software, the following packages have to be installed:</p>
<ul>
<li>C++ Rest SDK (Debian Bullseye: libssl1)</li>
<li>SSL Lib (Debian Bullseye: libssl1.1 )</li>
<li>Readline (Debian Bullseye: libreadline8)</li>
<li>NCurses (Debian: libncursesw6)</li>
</ul>
<p>Example: </p><pre class="fragment">apt-get update
apt-get install libjemalloc2 libcpprest libssl1.1 libreadline8 libncursesw6 libgoogle-glog0v5
</pre><h2>Compiling</h2>
<p>The program can alternatively be compiled from the sources.</p>
<h3>Requirements</h3>
<p>To be able to compile the main software, the following packages have to be installed:</p>
<ul>
<li>Jemalloc: (Optional Enhances performance.) (Debian: libjemalloc-dev)</li>
<li>Boost: The basic boost package + modules <code>system</code> , <code>regex</code> and <code>iostreams</code> (Debian: libboost-dev, libboost-system-dev, libboost-regex-dev, libboost-iostreams-dev)</li>
<li>NCurses: (Debian: libncursesw5-dev)</li>
<li>Readline (Debian Buster: libreadline-dev)</li>
</ul>
<p>For optional support for <code>FROM URL</code> imports, the following packages are also required:</p>
<ul>
<li>cpprest: C++ REST client (Debian: libcpprest-dev)</li>
<li>OpenSSL: OpenSSL for SSL support (Debian: libssl-dev) To use the included client for server/client mode the following additional package is needed:</li>
</ul>
<p>Example: </p><pre class="fragment">apt-get update
apt-get install libssl-dev libcpprest-dev libjemalloc-dev libboost-dev libboost-system-dev libboost-regex-dev libboost-program-options-dev libncurses5-dev libncursesw5-dev libreadline-dev
</pre><h3>Commands</h3>
<p>To compile the program in Release mode, the following commands can be used. </p><pre class="fragment">git clone https://github.com/JODA-Explore/JODA.git
cd JODA
mkdir build &amp;&amp; cd build
cmake -DCMAKE_BUILD_TYPE=Release ..
make
make install
</pre><h1>Program Flags</h1>
<p>These are options that may be supplied to the program during invokation.</p>
<ul>
<li><b>-h &ndash;help</b>: Shows help text and exits the program</li>
<li><b>&ndash;version</b>: Displays the version number</li>
<li><b>-d &ndash;data</b>: Data dictionary for benchmarks. (Default: current dictionary)</li>
<li><b>-s &ndash;nostorage</b>: Does not keep JSON files in memory. This results in less RAM usage, but increases execution time</li>
<li><b>&ndash;tmpdir</b>: Temporary directory to use. (Default: "/tmp/JODA")</li>
<li><b>-t &ndash;maxthreads</b>: Sets the maximum number of threads to be used. Default is all available threads</li>
<li><b>&ndash;logtostderr</b>: Writes log to terminal.</li>
<li><b>-c &ndash;time</b>: Times the execution</li>
<li><b>&ndash;benchfile</b>: Sets file in which time (and benchmark) results will be stored</li>
<li><b>-f &ndash;queryfile</b>: A JODA query file to execute</li>
<li><b>&ndash;server</b>: Starts the program in server mode (Needs port option)</li>
<li><b>-p &ndash;port</b>: Port on which the server will listen</li>
</ul>
<h1>CLI Commands</h1>
<p>These commands can be used any time within the program. The commands have to be entered followed by a <code>;</code>.</p><ul>
<li><code>quit</code>: Quits the program</li>
<li><code>cache</code>: Toggles usage of the cache</li>
<li><code>sources</code>: Lists all named data sources (and the # of documents stored in them)</li>
<li><code>results</code>: Lists all temporary data sources (and the # of documents stored in them)</li>
</ul>
<h1>Queries</h1>
<h2>Syntax</h2>
<p>The basic syntax of queries is:</p>
<div class="fragment"><div class="line">LOAD     &lt;COLLECTION&gt;   (&lt;SOURCES&gt;)</div>
<div class="line">(CHOOSE  &lt;PRED&gt;)</div>
<div class="line">(AS      &lt;PROJ&gt;)</div>
<div class="line">(AGG     &lt;AGG&gt;)</div>
<div class="line">(STORE   &lt;COLLECTION&gt;  | AS FILE &quot;&lt;FILE&gt;&quot; | AS FILES &quot;&lt;DIR&gt;&quot;)</div>
<div class="line">(DELETE  &lt;COLLECTION&gt;)</div>
</div><!-- fragment --><p>The execution order is <code>LOAD</code>-&gt;<code>CHOOSE</code>-&gt;<code>AS</code>-&gt;<code>AGG</code>-&gt;<code>STORE</code>-&gt;<code>DELETE</code>. </p><h3>Load</h3>
<p><code>LOAD &lt;COLLECTION&gt;</code> loads an previously stored result, for further usage in the following query, from variable <code>&lt;COLLECTION&gt;</code>.</p>
<p><code>LOAD &lt;COLLECTION&gt; &lt;SOURCES&gt;</code> imports data from the <code>&lt;SOURCES&gt;</code> into <code>&lt;COLLECTION&gt;</code> and continues the query with it. If <code>&lt;COLLECTION&gt;</code> already exists, the contents of <code>&lt;SOURCES&gt;</code> will be appended to it.</p>
<p><code>&lt;SOURCES&gt;</code> can be one or multiple single <code>&lt;SOURCE&gt;</code>, combined with <code>,</code>.</p>
<p>Instead of <code>&lt;SOURCES&gt;</code>, data can also be imported by an ongoing group by with the <code>FROM GROUPED &lt;EXP&gt;</code> command. (For more informations see <a href="#group-by">Group-By</a>)</p>
<h3>Sources</h3>
<p>Currently the following sources are implemented:</p>
<p><code>FROM FILE "&lt;FILE&gt;"</code> parses a single file in the path <code>&lt;FILE&gt;</code>. (Supports <a href="#sampling">sampling</a>)</p>
<p><code>FROM FILES "&lt;DIR&gt;"</code> parses all files in the directory <code>&lt;DIR&gt;</code>. (Supports <a href="#sampling">sampling</a>)</p>
<p><code>FROM URL "&lt;URL&gt;"</code> parses documents returned by a GET call to <code>&lt;URL&gt;</code>.</p>
<h4>Sampling</h4>
<p>Some sources may be sampled, to decrease memory footprint and/or improve query times.</p>
<p>To sample sources <code>SAMPLE X</code> has to be appended to a <code>&lt;SOURCE&gt;</code> command. <code>X</code> has to be a value between (0,1).</p>
<p>Keep in mind that sampling only skips documents in the sources. All results will only represent these sources.</p>
<p>Currently, no further extrapolations are performed by the system to project aggregations like sums or similar functions.</p>
<h3>CHOOSE (Optional)</h3>
<p><code>CHOOSE &lt;PRED&gt;</code> selects JSON documents according to the given predicates. If this command is not supplied, all documents will be retrieved.</p>
<p>The predicate can consist of the following:</p>
<ul>
<li><code>&lt;PRED&gt; &amp;&amp; &lt;PRED&gt;</code>: AND (Both predicates have to be fulfilled)</li>
<li><code>&lt;PRED&gt; || &lt;PRED&gt;</code>: OR (One of the predicates have to be fulfilled)</li>
<li><code>!&lt;PRED&gt;</code>: NEGATE (Returns the opposite of the given predicate)</li>
<li><code>(&lt;PRED&gt;)</code>: BRACKET (Predicates can be bracketed)</li>
<li><code>&lt;VAR&gt; &lt;CMP&gt; &lt;VAR&gt;</code>: COMPARE (Compares the given variables)</li>
<li><code>&lt;VAR&gt;</code>: Single variable/function</li>
</ul>
<h4>Variables</h4>
<p>Variables can be any of the following:</p><ul>
<li>Numbers (e.g.: <code>1</code>, <code>+3.14</code>, <code>-284674</code>)</li>
<li>Strings (e.g.: <code>"Hello World!"</code>)</li>
<li>Boolean (<code>true</code>, <code>false</code>)</li>
<li><a href="#json-pointer">JSON-Pointer</a> (e.g.: &lsquo;&rsquo;/test/3'`)</li>
<li><a href="#functions">Functions</a></li>
</ul>
<h4>Comparison</h4>
<p>Comparisons can be any of the following:</p><ul>
<li><code>==</code></li>
<li><code>!=</code></li>
<li><code>&gt;=</code></li>
<li><code>&gt;</code></li>
<li><code>&lt;=</code></li>
<li><code>&lt;</code></li>
</ul>
<p>Each does what is expected. For comparisions the following rules apply:</p>
<p>Pointer evaluate to the needed type. If the given pointer does not exist or the evaluated type is not compatible, then false is returned.</p>
<p>Every comparison may be applied to two strings, but they may not be compared to anything else.</p>
<p>Every comparison may be applied to two numbers, but they may not be compared to anything else.</p>
<p>Booleans can only be checked for equality or unequality and may not be compared to anything else.</p>
<h3>AS (Optional)</h3>
<p><code>AS &lt;PROJ&gt;</code> projects the chosen documents into the with <code>&lt;PROJ&gt;</code> given form. If this command is not supplied, the documents will stay as they are.</p>
<p>The projection command has the following syntax:</p>
<div class="fragment"><div class="line">&lt;PROJ&gt; :    (&#39;&lt;TOPOINTER&gt;&#39; : &lt;SOURCE&gt;), ...</div>
</div><!-- fragment --><p><code>&lt;TOPOINTER&gt;</code>: JSON-Pointer, see section <a href="#json-pointer">JSON-Pointer</a>, in which the supplied source will be stored </p><h4>Source</h4>
<p>Source can be any of the following:</p>
<ul>
<li><code>&lt;FROMPOINTER&gt;</code>: (Any)JSON-Pointer, see section <a href="#json-pointer">JSON-Pointer</a></li>
<li><a href="#functions">Function</a></li>
<li><a href="#set-function">Set-Function</a></li>
</ul>
<h4>Set Functions</h4>
<p>Set functions can provide multiple values, which results in duplication of the given document with different values in the specified attributes.</p>
<p>Currently the following set functions are implemented:</p><ul>
<li><code>FLATTEN(&lt;POINTER&gt;)</code>: (Any) If <code>&lt;POINTER&gt;</code> is of type array, each element contained within is distibuted over multiple documents.</li>
</ul>
<h4>Examples</h4>
<p>With the following JSON input: </p><div class="fragment"><div class="line">{</div>
<div class="line">    &quot;sub&quot;:</div>
<div class="line">        {</div>
<div class="line">            &quot;array&quot;:</div>
<div class="line">                [</div>
<div class="line">                    1,</div>
<div class="line">                    &quot;test&quot;,</div>
<div class="line">                    3</div>
<div class="line">                ]</div>
<div class="line">        }</div>
<div class="line">}</div>
</div><!-- fragment --><p>&lsquo;AS (&rsquo;/id':ID()),('/file':FILENAME()),('/arr_elt':FLATTEN('/sub/array')) ` could result in this JSON output:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;id&quot; :      12,</div>
<div class="line">    &quot;file&quot; :    &quot;/home/testuser/testjson.json&quot;,</div>
<div class="line">    &quot;arr_elt&quot; : 1</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">{</div>
<div class="line">    &quot;id&quot; :      12,</div>
<div class="line">    &quot;file&quot; :    &quot;/home/testuser/testjson.json&quot;,</div>
<div class="line">    &quot;arr_elt&quot; : &quot;test&quot;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">{</div>
<div class="line">    &quot;id&quot; :      12,</div>
<div class="line">    &quot;file&quot; :    &quot;/home/testuser/testjson.json&quot;,</div>
<div class="line">    &quot;arr_elt&quot; : 3</div>
<div class="line">}</div>
</div><!-- fragment --><h3>AGG (Optional)</h3>
<p><code>AGG &lt;AGG&gt;</code> aggregates the results of the projection. If no aggregation is supplied, the results will be returned as is.</p>
<p>The aggregation command has the following syntax:</p>
<div class="fragment"><div class="line">&lt;AGG&gt; :     (&#39;&lt;TOPOINTER&gt;&#39; : &lt;SOURCE&gt;), ...</div>
</div><!-- fragment --><h4>Keywords</h4>
<ul>
<li>__&lt;TOPOINTER&gt;__: JSON-Pointer, see section <a href="#json-pointer">JSON-Pointer</a>, in which result of the aggregation be stored</li>
</ul>
<p>Source can be any of the following functions:</p><ul>
<li><b>AVG(&lt;Number&gt;)</b>: (Number) Calculates the average of the found numbers.</li>
<li><b>AVG(&lt;Number&gt;,&lt;Bool&gt;)</b>: (Number) Calculates the average of the found numbers. If the second parameter is true, then the contents of arrays are averaged up too.</li>
<li><b><a class="el" href="df/dfc/namespacejoda_1_1queryparsing_1_1grammar.html#a9fc9163e086feb491168086be000bb31a98035a451b15740d41aef3b86664dd1a">COUNT()</a></b>: (Number) Counts the number of documents.</li>
<li><b>COUNT(&lt;ANY&gt;)</b>: (Number) Counts how often the given value/pointer exists.</li>
<li><b>SUM(&lt;Number&gt;)</b>: (Number) Calculates the sum of the found numbers.</li>
<li><b>SUM(&lt;Number&gt;,&lt;Bool&gt;)</b>: (Number) Calculates the sum of the found numbers. If the second parameter is true, then the contents of arrays are summed up too.</li>
<li><b>DISTINCT(&lt;Number/String/Bool&gt;)</b>: (Array[Any]) Returns an array of distinct found elements, non atomic values are discarded.</li>
<li><b>COLLECT(&lt;ANY&gt;)</b>: (Array[Any]) Returns an array of all elements.</li>
<li><b>ATTSTAT(&lt;Object&gt;)</b>: (Object) Returns a statistic about the attributes in the given object.</li>
<li><b>HISTOGRAM(&lt;Number&gt;,&lt;Number&gt;,&lt;Number&gt;,&lt;Number&gt;)</b>: (Object) Creates a histogram of the first parameter. The following parameters represent the number of buckets, the inclusive minimum value, and the exclusive maximum value.</li>
</ul>
<h4>GROUP BY</h4>
<p>Aggregations can also be grouped by a specified value.</p>
<div class="fragment"><div class="line">&lt;AGG&gt;           : (&#39;&lt;TOPOINTER&gt;&#39; : GROUP &lt;SOURCE&gt; &lt;AS&gt; BY &lt;VALUE&gt;)</div>
<div class="line">&lt;AS&gt; [optional] : AS &lt;IDENT&gt;</div>
<div class="line">&lt;IDENT&gt;         : Any variable name string.</div>
</div><!-- fragment --><p>**Note: ** Only atomic data types (string, number, boolean) can be used to group. Arrays and objects are ignored.</p>
<h4>Examples</h4>
<p>With the following JSON input: </p><div class="fragment"><div class="line">{&quot;num&quot;: 0, &quot;dyn&quot; : 1}</div>
<div class="line">{&quot;num&quot;: 1, &quot;dyn&quot; : 1}</div>
<div class="line">{&quot;num&quot;: 2, &quot;dyn&quot; : &quot;test&quot;}</div>
<div class="line">{&quot;num&quot;: 3, &quot;dyn&quot; : {&quot;sub&quot;:1}}</div>
<div class="line">{&quot;num&quot;: 4 }</div>
</div><!-- fragment --><p><b>Query</b> </p><div class="fragment"><div class="line">LOAD data</div>
<div class="line">AGG   (&#39;/sum&#39;:SUM(&#39;/num&#39;)),</div>
<div class="line">      (&#39;/count&#39;:COUNT(&#39;/dyn&#39;)),</div>
<div class="line">      (&#39;/distinct&#39;:DISTINCT(&#39;/dyn&#39;)),</div>
<div class="line">      (&#39;/grouped&#39; : GROUP COUNT(&#39;/num&#39;) AS count BY &#39;/dyn&#39;)</div>
</div><!-- fragment --><p><b>Result</b> </p><div class="fragment"><div class="line">{</div>
<div class="line">    &quot;sum&quot; : 10,</div>
<div class="line">    &quot;count&quot; : 4,</div>
<div class="line">    &quot;distinct&quot; : [1, &quot;test&quot;],</div>
<div class="line">    &quot;grouped&quot; : [</div>
<div class="line">      {</div>
<div class="line">        &quot;group&quot; : 1,</div>
<div class="line">        &quot;count&quot; : 2</div>
<div class="line">      },</div>
<div class="line">      {</div>
<div class="line">        &quot;group&quot; : &quot;test&quot;,</div>
<div class="line">        &quot;count&quot; : 2</div>
<div class="line">      }</div>
<div class="line">    ]</div>
<div class="line">}</div>
</div><!-- fragment --><h3>STORE (Optional)</h3>
<p><code>STORE &lt;VAR&gt;</code> stores the result of the query in variable <code>&lt;VAR&gt;</code>.</p>
<p><code>STORE AS FILE "&lt;FILE&gt;"</code> writes the result of the query to <code>&lt;FILE&gt;</code>.</p>
<p><code>STORE GROUPED BY &lt;SOURCE&gt;</code> groupes the dataset. (See <a href="#group-by">Group-By</a>) </p><h3>DELETE (Optional)</h3>
<p><code>DELETE &lt;VAR&gt;</code> removes the result stored in <code>&lt;VAR&gt;</code>.</p>
<h2>Group By</h2>
<p>Joda has the ability to group multiple documents together, depending on a value.</p>
<p>This is achieved by storing a dataset with the <code>GROUPED BY</code> clause.</p>
<p><code>STORE GROUPED BY &lt;SOURCE&gt;</code> groups all the documents, with the same value for <code>&lt;SOURCE&gt;</code>, together. To retrieve these grouped results a new query is necessary.</p>
<p><code>LOAD &lt;VAR&gt; FROM GROUPED &lt;SOURCE&gt;</code> will retrieve previously grouped results.</p>
<p>Multiple datasets can be grouped together, by repeatedly executing a <code>STORE</code> command with the same <code>&lt;SOURCE&gt;</code>.</p>
<p>After the <code>LOAD</code> statement, the grouping is complete and can no longer be referenced. </p><h3>Source</h3>
<p>Source can be any of the following:</p>
<ul>
<li><code>&lt;FROMPOINTER&gt;</code>: (Any)JSON-Pointer, see section <a href="#json-pointer">JSON-Pointer</a></li>
<li><a href="#functions">Function</a></li>
</ul>
<h3>Examples</h3>
<p>Lets assume we have multiple messages replying to each other: </p><div class="fragment"><div class="line">{</div>
<div class="line">    &quot;id&quot; : 2,</div>
<div class="line">    &quot;reply_to&quot; : 1,</div>
<div class="line">    &quot;msg&quot; : &quot;Hello World!&quot;,</div>
<div class="line">},</div>
<div class="line">{</div>
<div class="line">    &quot;id&quot; : 3,</div>
<div class="line">    &quot;reply_to&quot; : 1,</div>
<div class="line">    &quot;msg&quot; : &quot;Hello Joda!&quot;,</div>
<div class="line">}</div>
</div><!-- fragment --><p>Now we might want to get all replies to the same message. This can be achieved by combining these two queries:</p>
<div class="fragment"><div class="line">LOAD msgs</div>
<div class="line">STORE GROUPED BY &#39;/reply_to&#39;;</div>
<div class="line"> </div>
<div class="line">LOAD replies FROM GROUPED &#39;/reply_to&#39;;</div>
</div><!-- fragment --><p>This will return:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;reply_to&quot; : 1,</div>
<div class="line">    &quot;joins&quot; :</div>
<div class="line">       [</div>
<div class="line">           {</div>
<div class="line">               &quot;id&quot; : 2,</div>
<div class="line">               &quot;reply_to&quot; : 1,</div>
<div class="line">               &quot;msg&quot; : &quot;Hello World!&quot;,</div>
<div class="line">           },</div>
<div class="line">            {</div>
<div class="line">                &quot;id&quot; : 3,</div>
<div class="line">                &quot;reply_to&quot; : 1,</div>
<div class="line">                &quot;msg&quot; : &quot;Hello Joda!&quot;,</div>
<div class="line">            }</div>
<div class="line">       ]</div>
<div class="line">}</div>
</div><!-- fragment --><h2>Misc</h2>
<h3>Functions</h3>
<h5>Metadata-/File-Functions</h5>
<ul>
<li>(String) <code>FILENAME()</code>: Returns the filename (with full path), or "\[PROJECTION]" if the document was projected.</li>
<li>(Int) <code>FILEPOSSTART()</code>: Returns the starting position of the document, within it's file.</li>
<li>(Int) <code>FILEPOSEND()</code>: Returns the end position of the document, within it's file.</li>
<li>(Int) <code>ID()</code>: Returns the internal ID of the document.</li>
</ul>
<h5>Type-Functions</h5>
<ul>
<li>(String) <code>TYPE(Any)</code>: Returns the type of the given attribute ("OBJECT","ARRAY","NUMBER","STRING","BOOL","NULL");</li>
<li>(Bool) <code>EXISTS(Any)</code>: Checks if the given attribute exists.</li>
<li>(Bool) <code>ISX(Any)</code>: Checks if the given attribute has type X:<ul>
<li><code>ISNULL</code></li>
<li><code>ISBOOL</code></li>
<li><code>ISNUMBER</code></li>
<li><code>ISSTRING</code></li>
<li><code>ISOBJECT</code></li>
<li><code>ISARRAY</code></li>
</ul>
</li>
</ul>
<h5>Casting-Functions</h5>
<ul>
<li>(Number) <code>INT(Any)</code>: Returns the integer representation of the value. Floats are truncated, Strings are parsed as numbers if possible, and Boolean is converted to {1,0}.</li>
<li>(Number) <code>FLOAT(Any)</code>: Returns the float representation of the value. Strings are parsed as numbers if possible, and Boolean is converted to {1,0}.</li>
<li>(String) <code>STRING(Any)</code>: Returns the string representation of the value. Only works for non-object/array values.</li>
</ul>
<h5>String-Functions</h5>
<ul>
<li>(Number) <code>LEN(String)</code>: Returns the length of the string.</li>
<li>(String) <code>LOWER(String)</code>: Returns the string in lowercase.</li>
<li>(String) <code>UPPER(String)</code>: Returns the string in uppercase.</li>
<li>(String) <code>LTRIM(String)</code>: Trims spaces to the left of the string.</li>
<li>(String) <code>RTRIM(String)</code>: Trims spaces to the right of the string.</li>
<li>(String) <code>CONCAT(String,String)</code>: Concatenates two strings.</li>
<li>(Bool) <code>SCONTAINS(String,String)</code>: Returns true if first string contains the second.</li>
<li>(Bool) <code>STARTSWITH(String,String)</code>: Returns true if first string starts with the second.</li>
<li>(Number) <code>FINDSTR(String,String)</code>: Returns the position of the second string in the first string, or -1 if it is not contained.</li>
<li>(String) <code>SUBSTR(String,Number,Number)</code>: Returns a substring of the given string. The first number is the starting position of the substring, the second (optional) number is the length of the substring. If the second is not given, everything until the end is returned.</li>
<li>(Bool) <code>REGEX(String,String)</code>: Returns true if first string matches the regular expression defined in the second.</li>
<li>(Array(String)) <code>REGEX_EXTRACT(String,String)</code>: Returns a list of strings within the first parameter, matched by the regular expression in the second.</li>
<li>(String) <code>REGEX_REPLACE(String,String,String)</code>: Replaces all matches, within the first string, of the regular expression, defined in the second parameter, with the third string.</li>
</ul>
<h5>Array-Functions</h5>
<ul>
<li>(Number) <code>SIZE(Array)</code>: Returns the size of the array.</li>
<li>(Bool) <code>IN(Any,Array)</code>: Checks if parameter 1 is contained in the array given by parameter 2.</li>
</ul>
<h5>Object-Functions</h5>
<ul>
<li>(Number) <code>MEMCOUNT(Object)</code>: Returns the number of members.</li>
<li>(Array(String)) <code>LISTATTRIBUTES(Object)</code>: Returns all members in the given object.</li>
</ul>
<h5>Mathematical-Functions</h5>
<ul>
<li>(Number) <code>SUM(Number, Number)</code>: Calculates the sum of all arguments.</li>
<li>(Number) <code>SUB(Number, Number)</code>: Subtracts the arguments.</li>
<li>(Number) <code>PROD(Number, Number)</code>: Calculates the product of all arguments.</li>
<li>(Number) <code>DIV(Number, Number)</code>: Divides the arguments.</li>
<li>(Number) <code>MOD(Number, Number)</code>: Calculates the modulus.</li>
<li>(Number) <code>POW(Number, Number)</code>: Calculates the power.</li>
<li>(Number) <code>ABS(Number)</code>: Calculates the absolute.</li>
<li>(Number) <code>CEIL(Number)</code>: Calculates the ceiling.</li>
<li>(Number) <code>FLOOR(Number)</code>: Calculates the floor.</li>
<li>(Number) <code>TRUNC(Number)</code>: Truncates the value.</li>
<li>(Number) <code>ROUND(Number)</code>: Round the value.</li>
<li>(Number) <code>SQRT(Number)</code>: Calculates the square root</li>
<li>(Number) <code>DEGREES(Number)</code>: Radians to degrees.</li>
<li>(Number) <code>RADIANS(Number)</code>: Degrees to radians.</li>
</ul>
<h5>Trigonometric-Functions</h5>
<ul>
<li>(Number) <code>ACOS(Number)</code>: inverse cosine</li>
<li>(Number) <code>ASIN(Number)</code>: inverse sine</li>
<li>(Number) <code>ATAN(Number)</code>: inverse tangent</li>
<li>(Number) <code>ATAN2(Number, Number)</code>: inverse tangent of y/x</li>
<li>(Number) <code>COS(Number)</code>: cosine</li>
<li>(Number) <code>SIN(Number)</code>: sine</li>
<li>(Number) <code>TAN(Number)</code>: tangent</li>
</ul>
<h5>Mathematical-Constants</h5>
<ul>
<li>(Number) <code>PI()</code>: Returns PI</li>
</ul>
<h5>Time-Functions</h5>
<ul>
<li>(Number) <code>NOW()</code>: Returns the UNIX timestamp in milliseconds.</li>
</ul>
<h5>Misc-Functions</h5>
<ul>
<li>(Number) <code>SEQNUM()</code>: Returns a sequential number between 0 and the number of documents.<ul>
<li>Multiple <code>SEQNUM()</code> calls within one query each return a number in the range independently from each other. (e.g.: &lsquo;... AS (&rsquo;/seq1':SEQNUM()),('/seq2':SEQNUM())<code>could result in</code>{"seq1":1,"seq2":3}<code>.</code></li>
</ul>
</li>
<li><code>(Number)</code>HASH(Any)`: Returns the hash of the value.</li>
</ul>
<h4>Parameters</h4>
<p>The parameters are defined as:</p><ul>
<li><code>&lt;NUMBER&gt;</code>: (e.g.: <code>1</code>, <code>+3.14</code>, <code>-284674</code>)</li>
<li><code>&lt;STRING&gt;</code>: (e.g.: <code>"Hello World!"</code>)</li>
<li><code>&lt;BOOL&gt;</code>: (<code>true</code>, <code>false</code>)</li>
</ul>
<p>Each parameter can be replaced by a <a href="#json-pointer">JSON-Pointer</a>. If the attributed does not exist or is of wrong type, the function will return false (or another default value).</p>
<h3>JSON-Pointer</h3>
<p>JSON-Pointers are pointers to specific parts of a JSON document. The implementation conforms to the <a href="https://tools.ietf.org/html/rfc6901">RFC 6901</a>.</p>
<p>In this document: </p><div class="fragment"><div class="line">{</div>
<div class="line">    &quot;test&quot; :</div>
<div class="line">        [</div>
<div class="line">            1,</div>
<div class="line">            &quot;test&quot;,</div>
<div class="line">            {</div>
<div class="line">                &quot;sub&quot; : &quot;Hello World!&quot;</div>
<div class="line">            }</div>
<div class="line">        ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>The pointer &lsquo;&rsquo;/test/2/sub'` would point to the string "Hello World!".</p>
<p>The empty pointer &lsquo;&rsquo;'` points to the root object.</p>
<h2>Example Queries</h2>
<div class="fragment"><div class="line">LOAD A FROM FILES &quot;/home/user/jsondirectory&quot;</div>
<div class="line">CHOOSE &#39;/message/sender&#39; == &quot;Peter&quot;</div>
<div class="line">AS (&#39;/filename&#39; : FILENAME())</div>
<div class="line">AGG (&#39;/files&#39; : DISTINCT(&#39;/filename&#39;))</div>
<div class="line">STORE AS FILE &quot;/home/user/peters_files.json&quot;</div>
<div class="line">DELETE A</div>
</div><!-- fragment --><p>Loads all files in directory <code>/home/user/jsondirectory</code> and selects only those with the value "Peter" for the attribute <code>/message/sender</code>. From these selected documents the filenames, in which they where contained, is stored in <code>/filename</code>. The resulting documents are then aggregated by choosing all distinct filenames and storing them as array in the attribute <code>/files</code>.</p>
<p>The result is a single document, which is then written to the file <code>/home/user/peters_files.json</code>. Lastly the variable A is removed, so all documents are purged from the system.</p>
<h1>Citation</h1>
<p>If you want to cite this project in your research, please use our ICDE 2020 demo paper.</p>
<h2>Bibtex:</h2>
<div class="fragment"><div class="line">@inproceedings{DBLP:conf/icde/Schafer020,</div>
<div class="line">  author    = {Nico Sch{\&quot;{a}}fer and</div>
<div class="line">               Sebastian Michel},</div>
<div class="line">  title     = {{JODA:} {A} Vertically Scalable, Lightweight {JSON} Processor for</div>
<div class="line">               Big Data Transformations},</div>
<div class="line">  booktitle = {36th {IEEE} International Conference on Data Engineering, {ICDE} 2020,</div>
<div class="line">               Dallas, TX, USA, April 20-24, 2020},</div>
<div class="line">  pages     = {1726--1729},</div>
<div class="line">  publisher = {{IEEE}},</div>
<div class="line">  year      = {2020},</div>
<div class="line">  url       = {https://doi.org/10.1109/ICDE48307.2020.00155},</div>
<div class="line">  doi       = {10.1109/ICDE48307.2020.00155},</div>
<div class="line">  timestamp = {Fri, 05 Jun 2020 17:54:57 +0200},</div>
<div class="line">  biburl    = {https://dblp.org/rec/conf/icde/Schafer020.bib},</div>
<div class="line">  bibsource = {dblp computer science bibliography, https://dblp.org}</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.19
</small></address>
</body>
</html>
